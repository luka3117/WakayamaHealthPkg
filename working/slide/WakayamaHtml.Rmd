---
title: "和歌山県報告書"
subtitle: "健康寿命"
author: "李鍾賛(jc lee, 滋賀大助教、数理統計学博士)"
date: "最終更新: `r format(Sys.time(), '%Y/%m/%d')`"
output:
  # word_document:
  html_document:
   number_section: true
   toc: true
   code_folding: hide
   toc_float:
     smooth_scroll: false
     collapsed: false
  # fig_width: 18
  # fig_height: 12

# output:
#   ioslides_presentation:
#   widescreen: true
#   number_section: true
#   toc: true
#   transition: faster
  # css: 'scrollable_slides.css'

# runtime: shiny
# https://bookdown.org/yihui/rmarkdown/ioslides-presentation.html

# The following single character keyboard shortcuts enable alternate display modes:
#
# 'f': enable fullscreen mode
#
# 'w': toggle widescreen mode
#
# 'o': enable overview mode
#
# 'h': enable code highlight mode
#
# 'p': show presenter notes
---


#  データ情報：
- "DataFormat.csv" latest version 2021年2月10日

```{r, warning=FALSE}

# devtools::install_github(repo = "luka3117/JcPackage/OsakaUniv2020")

# 使用package
suppressMessages(library(readxl))
suppressMessages(library(dplyr))
suppressMessages(library(data.table))
suppressMessages(library(kableExtra))
suppressMessages(library(curl))
suppressMessages(library(tidyverse))
```




#  data import and pre-processing

- row data data 次元
- 94行と 168変数
- **168変数の中、一部の変数は男女の区別がないため、県単位のデータ(47行のデータ)として扱う**

-





```{r, warning=FALSE, message=FALSE}
getwd()
d<-read_csv("../..//data/DataFormat.csv", skip=1, locale = readr::locale(encoding = "CP932"))

d<-d[-95,]
d %>% dim()
d<-d %>% rename(key=X1)
d %>% DT::datatable()
```

## 変数名を英語に変換 :data名`d`
```{r}
var<-read.csv("../..//var_name_Eng.csv")
colnames(d)<-var$var_name_Eng
# d %>% DT::datatable()
```


### 変数名：和英対応表

```{r}
read.csv("../../JpnEng.csv") %>% DT::datatable()

```


## 男女区別のないデータ `d_common`
- 変数は 104
```{r}
d_common<-d[, sapply(d[48,], is.na)]

d_common<-d_common[1:47, ]

# d_common%>% DT::datatable()

d_common<-d %>% select(1:6) %>% .[1:47,] %>% bind_cols(d_common)

d_common %>% DT::datatable()
d_common %>% dim()

```

### `d_common` data 変数名

	-健康/疾患
	Trt_rate_Hospitalization_Malignant_neoplasm_2017
	Trt_rate_hospitalization_heart_dz_2017
	Trt_rate_Hospitalization_Cerebrovascular_dz_2017
	Trt_rate_Outpatient_Malignant_neoplasm_2017
	Trt_rate_outpatient_heart_dz_2017
	Trt_rate_Outpatient_Cerebrovascular_dz_2017
	-医療施設
	Num_of_hospitals_2019
	Num_of_clinics_2019
	Num_of_general_clinics
	HM_Num_of_general_hospitals
	HM_Num_of_general_dental_clinics_per_100k_pop
	HM_Num_of_doctors_engaged_in_medical_facilities_per_100k_pop
	HM_Num_of_public_health_nurses_per_100k_pop
	-医療従事者
	Num_of_certified_cancer_doctors_2020
	Num_of_cardiologists_2020
	Num_of_endoscopists_2020
	-文化
	Book_purchase_price_2019
	Num_of_libraries
	Sports_Participant_Rate
	Travel_Rate1
	Volunteer_Activity_Participant_Rate
	-人口
	pop_Young_pop_Ratio_2020
	pop_oldElderly_pop_Ratio_2020
	pop_Working_Age_pop_Ratio_2020
	pop_Rough_Mortality_2020
	pop_Double_income_household_ratio_2020
	-自然環境
	Natural_environment_annual_avg_temperature
	Natural_environment_annual_avg_relative_humidity
	Natural_environment_annual_rain
	Natural_environment_annual_Num_of_snow_days
	-経済
	Economic_pref_income
	Admin_base_Financial_strength_index
	Admin_base_balance_ratio
	Admin_infrastructure_living_protection_cost_ratio_(prefectural_finance)
	Admin_infrastructure_Edu_cost_ratio_(prefectural_finance)
	Gini_coeff_2014
	Income_Gini_Coeff_Working_Household_2014
	-教育
	Edu_Ptc_of_university_graduate_students_with_a_final_academic_background
	Academic_ability_middle_school_2015
	Academic_ability_elementary_school_2015
	-労働
	Labor_primary_industry_emp_ratio
	Labor_secondary_industry_emp_ratio
	Labor_tertiary_industry_emp_ratio
	Labor_Unemp_rate
	Total_working_hours_2016
	Total_salary_2016
	-住居
	Residence_owner_ratio
	Residence_house_ratio
	Residence_water_supply_pop_ratio
	Residence_sewerage_ratio
	Residential_city_park_area_(per_pop)
	Residence_road_pavement_rate
	Residence_simachi_pavement_rate
	Safety_Num_of_traffic_accidents_per_100k_pop
	Residence_Num_of_city_parks
	-家計経済
	Household_actual_income
	Household_consumption_expenditure
	Household_Edu_cost_ratio
	Household_Liberal_Arts_and_Entertainment_Expenditure_Ratio
	Household_Savings
	Household_Smartphone_ownership_quantity
	Household_PC_ownership_quantity
	Household_Car_ownership_quantity
	Household_Tablet_terminal_Ownership_quantity
	pop_Household_Ratio_of_elderly_single_person_households
	-疾患
	Hypertension_Hospitalization_2014
	Hypertension_Outpatient_2014
	Diabetes_hospitalization_2014
	Diabetes_Outpatient_2014
	Total_Num_of_caries_2014
	Total_Num_of_periodontal_2014
	Bone_density_disorder_2014
	Fracture_2014
	Tooth_supplement_2014
	Alzheimer_dz_2014
	-食
	Meat_2014
	Seafood_2014
	Milk_2014
	Dairy_2014
	Egg_2014
	Soybean_2014
	-住居施設
	Usual_barrier_free_handrails_2013
	Usual_barrier_free_no_steps_2013
	High_barrier_free_handrails_2013
	High_barrier_free_no_steps_2013
	High_barrier_free_wheelchairs_pass_Width
	-食消費
	Fish_meat_consumption_2014
	Fish_meat_consumption_2015
	Fish_meat_consumption_2016
	Fish_meat_consumption_avg_2014_2016
	Confectionery_consumption_2014
	Confectionery_consumption_2015
	Confectionery_consumption_2016
	Confectionery_consumption_avg_2014_2016
	Fruits_consumption_2014
	Fruits_consumption_2015
	Fruits_consumption_2016
	Fruit_consumption_avg_2014_2016



```{r, warning=FALSE}
d_common %>% colnames() %>%tbl_df() %>%  DT::datatable()


```

- 男女区別のないデータの***変数は`r dim(d_common)[2]-6`個***

## 男女区別のあるデータ `d_mf`,`d_m`,`d_f`

### `d_mf`

```{r}
name <- function(x) {
  !is.na(x)
}
d_mf<-d[, sapply(d[48,], name)]
d_mf %>% DT::datatable()
d_mf %>% dim()
d_m<-d_mf %>% filter(sex=="M")
d_f<-d_mf %>% filter(sex=="F")
# summary(d_mf)

```

### 男性データ`d_m`

```{r}
d_m %>% DT::datatable()
```

### 女性データ`d_f`
```{r}
d_f %>% DT::datatable()
```


## 以下分析対象データ`d_common`, `d_m`, `d_f`

# dataの変数属性を確認 {.tabset .tabset-fade .tabset-pills}

## `d_common`


## `d_m`


## `d_f`



# 寿命(目的変数)の都道府県の順位確認{.tabset .tabset-fade .tabset-pills}

## 男性の平均寿命


```{r}
d_m %>% select(LE_2015) %>% bind_cols(Wakayama::pref["pref.J"]) %>% dplyr::arrange(LE_2015) %>% mutate(rank=row_number()) %>%DT::datatable()
```


```{r}
jc.dotplot <- function(x) {
  # x is HLE or LE in c()　vector
  names(x)<-Wakayama::pref$pref.J
  x<-x[order(x)]

}

colfunc <- colorRampPalette(c("gray90","black"))

par(family= "HiraKakuProN-W3")

dotchart(
  main = "平均寿命(2015年, 男性)",
  jc.dotplot(d_m$LE_2015),
  cex = 0.7,
  lcolor = "gray90",
  pch = 19,
  col = colfunc(47),
  pt.cex = 1.5
)

abline(v = 79, lty = 2)

```



## 男性の健康寿命

```{r}
d_m %>% select(HLE_2016) %>% bind_cols(Wakayama::pref["pref.J"]) %>% dplyr::arrange(HLE_2016) %>% mutate(rank=row_number()) %>%DT::datatable()
```


```{r}
jc.dotplot <- function(x) {
  # x is HLE or LE in c()　vector
  names(x)<-Wakayama::pref$pref.J
  x<-x[order(x)]

}

colfunc <- colorRampPalette(c("gray90","black"))

par(family= "HiraKakuProN-W3")

dotchart(
  main = "健康寿命(2016年, 男性)",
  jc.dotplot(d_m$HLE_2016),
  cex = 0.7,
  lcolor = "gray90",
  pch = 19,
  col = colfunc(47),
  pt.cex = 1.5
)

abline(v = 79, lty = 2)

```



## 女性の平均寿命


```{r}
d_f %>% select(LE_2015) %>% bind_cols(Wakayama::pref["pref.J"]) %>% dplyr::arrange(LE_2015) %>% mutate(rank=row_number()) %>%DT::datatable()
```


```{r}
jc.dotplot <- function(x) {
  # x is HLE or LE in c()　vector
  names(x)<-Wakayama::pref$pref.J
  x<-x[order(x)]

}

colfunc <- colorRampPalette(c("gray90","black"))

par(family= "HiraKakuProN-W3")

dotchart(
  main = "平均寿命(2015年, 女性)",
  jc.dotplot(d_f$LE_2015),
  cex = 0.7,
  lcolor = "gray90",
  pch = 19,
  col = colfunc(47),
  pt.cex = 1.5
)

abline(v = 79, lty = 2)

```





## 女性の健康寿命


```{r}
d_f %>% select(HLE_2016) %>% bind_cols(Wakayama::pref["pref.J"]) %>% dplyr::arrange(HLE_2016) %>% mutate(rank=row_number()) %>%DT::datatable()
```


```{r}
jc.dotplot <- function(x) {
  # x is HLE or LE in c()　vector
  names(x)<-Wakayama::pref$pref.J
  x<-x[order(x)]

}

colfunc <- colorRampPalette(c("gray90","black"))

par(family= "HiraKakuProN-W3")

dotchart(
  main = "平均寿命(2015年, 女性)",
  jc.dotplot(d_f$HLE_2016),
  cex = 0.7,
  lcolor = "gray90",
  pch = 19,
  col = colfunc(47),
  pt.cex = 1.5
)

abline(v = 79, lty = 2)

```




# 説明変数の順位確認

## `d_common data`


# 出典整理

- [寿命][1]



/Users/jlee/Dropbox/00000健康和歌山県/0 wakayamaPkg/変数説明 from Wakayama.txt

から出典整理




[1]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00450022&tstat=000001031167&cycle=7&tclass1=000001124800&tclass2=000001124802

[2]:https://www.mhlw.go.jp/toukei/saikin/hw/iryosd/19/

[3]:https://www.jbct.jp/general/figure.html

[4]:https://www.j-circ.or.jp/senmoni_kensaku/

[5]:https://www.jges.net/medical/about/list/memberlist#92

[6]:https://ganjoho.jp/reg_stat/statistics/dl/index.html#pref_mortality

[7]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200561&tstat=000000330001&cycle=7&year=20190&month=0&tclass1=000000330001&tclass2=000000330004&tclass3=000000330005&result_back=1&cycle_facet=tclass1%3Atclass2%3Atclass3%3Acycle

[8]:https://www.mhlw.go.jp/toukei/saikin/hw/life/tdfk15/index.html

[9]:http://toukei.umin.jp/kenkoujyumyou/

[10]:https://ganjoho.jp/reg_stat/statistics/dl/index.html#pref_mortality

[11]:https://www.mhlw.go.jp/toukei/saikin/hw/jinkou/other/15sibou/index.html

[12]:http://www.stat.go.jp/data/kokusei/2015/kekka.html

[13]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200533&tstat=000001095335&cycle=0&tclass1=000001095377&tclass2=000001095378&tclass3=000001095386&tclass4=000001095387

[14]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200533&tstat=000001095335&cycle=0&tclass1=000001095377&tclass2=000001095378&tclass3=000001095386&tclass4=000001095389

[15]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[16]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[17]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[18]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[19]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[20]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[21]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[22]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[23]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[24]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[25]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[26]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[27]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[28]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[29]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[30]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[31]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[32]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[33]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[34]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[35]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[36]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[37]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[38]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[39]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[40]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[41]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[42]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[43]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307

[44]:https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200502&tstat=000001137306&cycle=0&year=20200&month=0&tclass1=000001137307






[aa]:https://www.keisan.nta.go.jp/kyoutu/ky/sm/top#bsctrl


## [][]

[]:https


# 順位確認


# 分布確認




# d %>% colnames() %>% tbl_df() %>%
#   write_csv("var_name_Jpn.csv")


# ----------------- data varname change
d

d %>% select(contains("dz"))


# -----------------　data Jpn and Eng table

# 連番

JpnEng <-
  read_csv(file = "var_name_Jpn.csv") %>% bind_cols(., read_csv(file = "var_name_Eng.csv")) %>%
  mutate(id = row_number()) %>%
  select(id, everything())

# write_csv(JpnEng, "JpnEng.csv")


# ----------------- descriptve stat

# install.packages("DataExplorer")
library(DataExplorer)


# d %>% select(Treatment_rate_Hospitalization_Malignant_neoplasm_2017:pop_Double_income_household_ratio_2020) %>%
# DataExplorer::create_report()








d_m

d_f




# [1] "d"        
"d_common"
"d_mf"     

```


```{r,warning=FALSE}
# 使用package
# suppressMessages(library(readxl))
# suppressMessages(library(dplyr))
# suppressMessages(library(data.table))
# suppressMessages(library(kableExtra))
# suppressMessages(library(curl))
suppressMessages(library(tidyverse))
library(gapminder) # to access gapminder dataset
suppressMessages(library(plotly)) # for plotly charts, pipe % operator
library(dplyr) # for any data manipulation operations; we used
# suppressMessages(library(tidyverse))
```


<!-- # 準備：Rの紹介(Quick tutorial of R) -->

<!-- ##  Rとは電卓のようなもの  -->

<!-- - Use symbol `< -` は代入を意味 -->

<!-- ```{r} -->
<!-- x <- 2 -->
<!-- x -->
<!-- x + x -->
<!-- ``` -->

<!-- - $exp(2)=e^{-2}$ -->
<!-- ```{r} -->
<!-- exp(-2) -->
<!-- log(10) -->
<!-- ``` -->


<!-- ## data とは個体と変数として構成 -->
<!--   - observation and variable -->
<!--   - 行と列 -->

<!-- ```{r} -->
<!-- iris %>% head(2) -->
<!-- iris %>% tail(2) -->
<!-- ``` -->

<!-- ## Rの`$`記号  -->

<!-- - `$` は特定の変数（列）を選択   -->

<!-- ```{r} -->
<!-- iris$Sepal.Length -->
<!-- ``` -->


<!-- # gapminder data -->

<!-- ## gapminder data 概要 -->

<!-- - 平均寿命(life expectancy)、一人当たりGDP(GDP per capita)、国別の人口(population by country)等に関するデータ -->

<!-- - gapminder has **1704** rows and **6** variables -->

<!-- ## gapminder 変数一覧 -->

<!--   - country: factor with 142 levels -->
<!--   - continent: factor with 5 levels -->
<!--   - year: ranges from 1952 to 2007 in increments of 5 years -->
<!--   - lifeExp : life expectancy at birth, in years -->
<!--   - pop: population -->
<!--   - gdpPercap: GDP per capita (US$, inflation-adjusted) -->


<!-- ## Quick glance of gapminder dataset -->

<!-- - using `str()` and ` %>% ` -->


<!-- ```{r} -->
<!-- gapminder %>% str() -->
<!-- ``` -->

<!-- ##  gapminder summary -->

<!-- - 次元（行と列の数） -->
<!-- ```{r} -->
<!-- gapminder %>% dim() -->
<!-- ``` -->


<!-- - 頻度表 -->
<!-- ```{r} -->
<!-- gapminder$year %>% table() -->
<!-- ``` -->



<!-- ##  gapminder summary1 -->
<!-- ```{r} -->
<!-- gapminder %>% summary() -->
<!-- ``` -->

<!-- ## gapminderのplot -->

<!-- - 2002年のデータに範囲を絞り、x軸は対数変換を施す -->

<!-- ```{r} -->
<!-- gapminder2002 <- gapminder %>% filter(year == 2002)  -->

<!-- plot(log(gapminder2002$gdpPercap), gapminder2002$lifeExp) -->

<!-- ``` -->





<!-- # mtcars data -->

<!-- ## mtcars data 概要: -->

<!-- -  Motor Trend Car Road Tests -->
<!-- - [motortrend](https://www.motortrend.com)とは  -->

<!-- - The data was extracted from the 1974 Motor Trend US magazine, and comprises fuel consumption and 10 aspects of automobile design and performance for 32 automobiles (1973–74 models). -->

<!-- - 1974年のモータートレンドUSマガジンの記事から -->
<!-- 32台の自動車（1973〜74モデル）を対象に、燃料消費量、設計、性能など10項目を計測したデータ -->

<!-- ## mtcars 次元と変数の概要: -->

<!--   - 32 observations and  11 variables -->

<!--   - mpg:	Miles/gallon -->
<!--   - cyl:	Number of cylinders(シリンダーの数) -->
<!--   - disp:	Displacement(排気量)  -->
<!--   - hp:	Gross horsepower(馬力) -->
<!--   - drat:	Rear axle ratio -->
<!--   - wt:	Weight (1000 lbs) (重量: 1000ポンド) -->
<!--   - qsec:	1/4 mile time -->
<!--   - vs:	Engine (0 = V字型, 1 = ストレート) エンジン -->
<!--   - am:	Transmission (0 = automatic, 1 = manual)  -->
<!--   - gear:	Number of forward gears(前進ギアの数) -->
<!--   - carb:	Number of carburetors(キャブレターの数) -->

<!-- ## mtcars の構造:`str()` -->
<!-- ```{r} -->
<!-- str(mtcars) -->
<!-- ``` -->

<!-- ## Create bar chart :`cyl` vs `n` -->

<!-- ```{r, warning=FALSE} -->
<!-- mtcars %>%  -->
<!--   mutate(cyl = as.factor(cyl)) %>%  # convert cyl to categorical variable -->
<!--   count(cyl) %>%  ## count to get the frequency table (from dplyr package) -->
<!--   plot_ly(x=~cyl,   -->
<!--           y=~n,  -->
<!--           color=~cyl, -->
<!--           text = ~n, -->
<!--           hoverinfo = "text") %>%  # apply plotly on the frequency data -->
<!--   add_bars(width=0.3) %>%  # use the width argument to adjust the width of the bars -->
<!--   layout(title="Bar Chart using mtcars data", -->
<!--          xaxis = list(title="Cylinder数"), -->
<!--          yaxis = list(title = "Count n")) -->
<!-- ``` -->




<!-- ## Grouped Bar chart(`am` vs `cyl` vs `n`) -->
<!--   - Using the mtcars dataset -->
<!--   - Using two categorical variables (Car Cylinder type and Transmission type) -->

<!-- ```{r, echo=TRUE, warning=FALSE, fig.width=5} -->

<!-- ## Side by Side or Grouped Bar Chart -->
<!-- mtcars %>%  -->
<!--   mutate(cyl = as.factor(cyl),  -->
<!--          am = as.factor(am)) %>% # Data type conversion -->
<!--   count(cyl, am) %>%  ## count to get the frequency table (from dplyr package) -->
<!--   plot_ly(x=~cyl,  -->
<!--           y=~n,  -->
<!--           color=~am, -->
<!--           text = ~n, -->
<!--           hoverinfo = "text") %>%  -->
<!--   add_bars() %>%  -->
<!--   layout(title="Plotly Grouped Bar Chart", -->
<!--          xaxis = list(title="No. of Cylinders"), -->
<!--          yaxis = list(title = "Count"), -->
<!--          barmode="group") -->
<!-- ``` -->

<!-- ## Stacked Bar chart -->
<!-- ```{r, warning=FALSE} -->
<!-- ## Stacked Bar chart -->
<!-- mtcars %>%  -->
<!--   mutate(cyl = as.factor(cyl),  -->
<!--          am = as.factor(am)) %>%  -->
<!--   count(cyl, am) %>% ## count to get the frequency table (from dplyr package) -->
<!--   plot_ly(x=~cyl,  -->
<!--           y=~n,  -->
<!--           color=~am, -->
<!--           text = ~paste("No. of cyl=", cyl, "<br>", "Count=", n, "<br>", "Transmission=", am),  -->
<!--           hoverinfo = "text") %>%  -->
<!--   add_bars() %>%  -->
<!--   layout(title="Plotly Stacked Bar Chart", -->
<!--          xaxis = list(title="No. of Cylinders"), -->
<!--          yaxis = list(title = "Count"), -->
<!--          barmode="stack") -->


<!-- ``` -->

<!-- # diamonds data  -->

<!-- ## diamonds dataset : -->


<!-- [diamond](https://ralphjacobs.co.za/why-choose-moissanite/) -->

<!-- [diamond](https://www.wedding-memo.com/ring/003.html) -->

<!-- - 価格のヒストグラム -->

<!-- ```{r} -->
<!-- library(ggplot2) # for diamonds dataset -->

<!-- diamonds %>%  -->
<!--   plot_ly() %>%  -->
<!--   add_histogram(x=~price) -->
<!-- ``` -->


<!-- ##  Histogram with `cut` -->
<!-- ```{r} -->
<!-- # Histogram with categorical variable -->
<!-- diamonds %>%  -->
<!--   plot_ly() %>%  -->
<!--   add_histogram(x=~cut)  -->
<!-- ``` -->


<!-- ## Histogram with `cut` and `clarity` -->
<!-- ```{r} -->
<!-- diamonds %>%  -->
<!--   plot_ly() %>%  -->
<!--   add_histogram(x=~cut, color=~clarity) -->
<!-- ``` -->

<!-- ## Create Heatmap -->
<!-- ```{r} -->
<!-- ## Create a heatmap -->
<!-- diamonds %>%  -->
<!--   plot_ly() %>%  -->
<!--   add_heatmap(x=~cut, y=~color, z=~price) -->
<!-- ``` -->

<!-- <!-- ## Animated Charts --> -->
<!-- <!--   - Animated Scatter Chart with year timeline --> -->

<!-- <!-- ```{r, echo=FALSE} --> -->

<!-- <!-- library(dplyr) # for data manipulation --> -->
<!-- <!-- library(plotly) # for plotly charts --> -->
<!-- <!-- library(purrr) # for cumulative dataset --> -->
<!-- <!-- library(crosstalk) # for plot linking --> -->
<!-- <!-- library(gapminder) # for gapminder dataset --> -->


<!-- <!-- gapminder %>%  --> -->
<!-- <!--   plot_ly(x=~gdpPercap, y=~lifeExp) %>%  --> -->
<!-- <!--   add_markers(frame=~year, ids=~country, showlegend = FALSE) %>%  --> -->
<!-- <!--   layout(title="Animated Scatter Plotly Chart", --> -->
<!-- <!--          xaxis=list(title="GDP Per Capita", type="log"), --> -->
<!-- <!--          yaxis=list(title= "Life Expectancy")) --> -->


<!-- <!-- ``` --> -->



<!-- # storms data -->

<!-- ## Animated bar chart -->

<!-- [storm](https://twitter.com/USATODAY/status/606188977985605633/photo/1) -->


<!-- ```{r} -->
<!-- storms %>%  -->
<!--   count(year, status) %>% -->
<!--   plot_ly(y=~status, x =~n, color=~status) %>%  -->
<!--   add_bars(frame=~year) %>% -->
<!--   layout(barmode="stack") -->
<!-- ``` -->



<!-- ## Line chart -->
<!-- ```{r} -->
<!-- # library(plotly) -->

<!-- # Line chart of storms by year -->
<!-- storms %>%  -->
<!--   count(year, status) %>%  -->
<!--   plot_ly(x=~year, y=~n) %>%  -->
<!--   add_lines(color=~status) -->
<!-- ``` -->


<!-- ## 累積頻度 アニメ line plot -->
<!-- ```{r} -->
<!-- storms %>% count(year) %>% split(.$year) %>% accumulate(~bind_rows(.x, .y)) %>%  -->
<!--   set_names(1975:2015) %>% # optional -->
<!--   bind_rows(.id="年") %>% -->
<!--   plot_ly(x=~year, y=~n) %>%  -->
<!--   add_lines(frame=~年) -->
<!-- ``` -->


<!-- ## 累積頻度 アニメ line plot by category -->

<!-- ```{r,warning=FALSE} -->
<!-- storms %>% count(year, category) %>% split(.$year) %>% accumulate(~bind_rows(.x, .y)) %>%  -->
<!--   set_names(1975:2015) %>% # optional -->
<!--   bind_rows(.id="frame") %>% -->
<!--   plot_ly(x=~year, y=~n) %>%  -->
<!--   add_lines(frame=~frame, color=~category, ids=~category) -->

<!-- ``` -->


<!-- ## 累積頻度 アニメ line plot by status -->

<!-- ```{r, echo=FALSE} -->
<!-- storms %>%  -->
<!--   count(year, status) %>%  -->
<!--   split(.$year) %>%  -->
<!--   accumulate(~bind_rows(.x, .y)) %>%  -->
<!--   set_names(1975:2015) %>% # optional -->
<!--   bind_rows(.id="frame") %>% -->
<!--   plot_ly(x=~year, y=~n) %>%  -->
<!--   add_lines(frame=~frame, color=~status, ids=~status) -->

<!-- ``` -->

<!-- # よりお洒落なplot - gapminder revisited -->


<!-- <!-- ```{r, eval=FALSE  } --> -->
<!-- <!-- gapminder %>% --> -->
<!-- <!--   filter(year == 2002) %>%  # filter data for the year 2002 --> -->
<!-- <!--   plot_ly() %>% --> -->
<!-- <!--   add_markers(x =  ~ gdpPercap, y =  ~ lifeExp) %>% --> -->
<!-- <!--   ## Add title to the plot, and axis. Apply log transformation to the x axis --> -->
<!-- <!--   layout( --> -->
<!-- <!--     title = "Plotly Scatter Plot", --> -->
<!-- <!--     xaxis = list(title = "GDP Per Capita (log scale)", type = "log"), --> -->
<!-- <!--     yaxis = list(title = "Life Expectancy") --> -->
<!-- <!--   )  --> -->

<!-- <!-- ``` --> -->

<!-- ##  -->
<!-- ```{r, warning=FALSE} -->
<!-- ## Scatter plot for a specific year 2002 -->
<!-- gapminder %>% -->
<!--   filter(year == 2002) %>%  # filter data for the year 2002 -->
<!--   plot_ly() %>% -->
<!--   add_markers(x =  ~ gdpPercap, y =  ~ lifeExp) %>% -->
<!--   ## Add title to the plot, and axis. Apply log transformation to the x axis -->
<!--   layout( -->
<!--     title = "Plotly Scatter Plot", -->
<!--     xaxis = list(title = "GDP Per Capita (log scale)", type = "log"), -->
<!--     yaxis = list(title = "Life Expectancy") -->
<!--   ) %>% -->
<!--   hide_legend() -->
<!-- ``` -->

<!-- ## 年度ごとに変化するアニメーションを作成 -->

<!-- - 年度変数を frame に指定（`frame=~year`） -->
<!-- -  Frame is transitioned over the years to bring a smooth animation effect -->
<!-- ```{r,echo=FALSE, warning=FALSE} -->
<!-- gapminder %>% -->
<!--   plot_ly() %>% -->
<!--   # add frame argument for animation and map to the variable needed on the timeline -->
<!--   add_markers(x=~gdpPercap, y=~lifeExp, -->
<!--               frame=~year, -->
<!--               text=~paste("Country:", country), -->
<!--               hoverinfo= "text") %>% -->
<!--   layout(title="Animated Plotly Scatter Plot", -->
<!--          xaxis=list(title="GDP Per Capita (log scale)(一人当たりGDP)", type="log"), -->
<!--          yaxis=list(title= "Life Expectancy(平均寿命)")) %>% -->
<!--   hide_legend() -->
<!-- ``` -->


<!-- ## Animated bubble chart with year timeline -->

<!-- [You've never seen data presented like this](https://www.ted.com/talks/hans_rosling_the_best_stats_you_ve_ever_seen?referrer=playlist-the_best_hans_rosling_talks_yo#t-213748) -->


<!--   - Size of the bubble : the population(人口) -->
<!--   - Color of the bubble : the continent(大陸) -->
<!--   - Add text/ Add Pause button -->

<!-- ##  -->

<!-- ```{r, warning=FALSE} -->
<!-- gapminder %>%  -->
<!--   plot_ly(x=~gdpPercap, y=~lifeExp) %>%  -->
<!--   add_markers(frame=~year,  -->
<!--               ids=~country, -->
<!--               size = ~pop, -->
<!--               color=~continent, -->
<!--               text = ~country, -->
<!--               hoverinfo = "text",  -->
<!--               marker=list(sizemode="diameter")) %>%  -->
<!--   layout(title="Animated Scatter Plotly Chart",xaxis=list(title="GDP Per Capita", type="log"), -->
<!--          yaxis=list(title= "Life Expectancy")) %>%  -->
<!--   animation_button(label = "Click me!", -->
<!--                    x=1, -->
<!--                    y=1, -->
<!--                    xanchor="right", -->
<!--                    yanchor="bottom") %>%  -->
<!--   animation_opts(frame = 700,  -->
<!--                  transition = 350,  -->
<!--                  easing="linear",  -->
<!--                  redraw = FALSE) %>%  -->
<!--   animation_slider(hide=F,  -->
<!--                    currentvalue=list(prefix=NULL, -->
<!--                                      font = list(color="GREY", size=30))) -->
<!-- ``` -->






<!-- https://www.ted.com/talks/hans_rosling_the_best_stats_you_ve_ever_seen?referrer=playlist-the_best_hans_rosling_talks_yo#t-213748 -->
