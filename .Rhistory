jc.dotplot <- function(x) {
# x is HLE or LE in c()　vector
names(x)<-Wakayama::pref$pref.J
x<-x[order(x)]
}
colfunc <- colorRampPalette(c("gray90","black"))
par(family= "HiraKakuProN-W3")
dotchart(
main = "平均寿命(2015年, 女性)",
jc.dotplot(d_f$HLE_2016),
cex = 0.7,
lcolor = "gray90",
pch = 19,
col = colfunc(47),
pt.cex = 1.5
)
abline(v = 79, lty = 2)
d_common %>% dplyr::select_if(is.numeric) %>% sapply(rank) %>%
tbl_df() %>%dplyr::filter(key==30) %>% t() %>% as.data.frame() %>% DT::datatable()
d_common %>% dplyr::select_if(is.numeric)
d_common %>% dplyr::select_if(is.numeric)
aaa<-d_common %>% dplyr::select_if(is.numeric)
aaa %>% colnames()
pivot_longer(
data = aaa,
cols =
-key, -pref.id
names_to =aa ,
values_to =bb
)
aa %>% colnames()
pivot_longer(
data = aaa,
cols =
-key, -pref.id,
names_to =aa ,
values_to =bb
)
aaa %>% colnames()
pivot_longer(
data = aaa,
cols =-key,
names_to =aa ,
values_to =bb
)
aaa %>% colnames()
pivot_longer(
data = aaa,
cols =-key,
names_to =aa ,
values_to =bb
)
aaa %>% colnames()
pivot_longer(
data = aaa,
cols =-key,
names_to =aa ,
values_to =bb
)
pivot_longer(
data = aaa,
cols =-key
# ,
# names_to =aa ,
# values_to =bb
)
names_to ="aa" ,
pivot_longer(
data = aaa,
cols =-key,
names_to ="aa" ,
values_to ="bb"
)
d_common %>% dplyr::select_if(is.numeric) %>%
pivot_longer(
cols =-key,
names_to ="var_name" ,
values_to ="value"
)
aaa<-
d_common %>% dplyr::select_if(is.numeric) %>%
pivot_longer(
cols =-key, -pref.id
names_to ="var_name" ,
values_to ="value"
)
aaa<-
d_common %>% dplyr::select_if(is.numeric) %>%
pivot_longer(
cols = -key:-pref.id
names_to ="var_name" ,
values_to ="value"
)
aaa<-
d_common %>% dplyr::select_if(is.numeric) %>%
pivot_longer(
cols = -key
names_to ="var_name" ,
values_to ="value"
)
aaa<-
d_common %>% dplyr::select_if(is.numeric) %>%
pivot_longer(
cols = -key, -pref.id,
names_to ="var_name" ,
values_to ="value"
)
aaa<-
d_common %>% dplyr::select_if(is.numeric) %>%
pivot_longer(
cols = -key, -pref.id,
names_to ="var_name" ,
values_to ="value"
)
aaa<-
d_common %>% dplyr::select_if(is.numeric) %>%
pivot_longer(
cols = -key, -"pref.id",
names_to ="var_name" ,
values_to ="value"
)
aaa<-
d_common %>% dplyr::select_if(is.numeric) %>%
pivot_longer(
cols = -key, -Trt_rate_Hospitalization_Malignant_neoplasm_2017,
names_to ="var_name" ,
values_to ="value"
)
aaa<-
d_common %>% dplyr::select_if(is.numeric) %>%
pivot_longer(
cols = -c("key", "pref.id"),
names_to ="var_name" ,
values_to ="value"
)
aaa<-
d_common %>% dplyr::select_if(is.numeric) %>%
pivot_longer(
cols = -c("key", "pref.id"),
names_to ="var_name" ,
values_to ="value"
)
aaa<-
d_common %>% dplyr::select_if(is.numeric) %>%
pivot_longer(
cols = -c("key", "pref.id"),
names_to ="var_name" ,
values_to ="value"
)
d_common %>% dplyr::select_if(is.numeric) %>%
pivot_longer(
cols = -c("key", "pref.id"),
names_to ="var_name" ,
values_to ="value"
)
d_common %>% dplyr::select_if(is.numeric) %>%
pivot_longer(
cols = -c("key", "pref.id"),
names_to ="var_name" ,
values_to ="value"
) %>% select(-key)
temp<-d_common %>% dplyr::select_if(is.numeric) %>%
pivot_longer(
cols = -c("key", "pref.id"),
names_to ="var_name" ,
values_to ="value"
) %>% select(-key)
ggplot(data = temp, mapping = aes(x = value))+geom_histogram()
ggplot(data=temp, aes(x = value))+theme_bw(base_family = "HiraKakuProN-W3") +
facet_grid(name~Species,scales="free" )+
geom_density()
temp
ggplot(data=temp, aes(x = value))+
theme_bw(base_family = "HiraKakuProN-W3") +
facet_grid(~pref.id,scales="free" )+
geom_density()
?facet_wrap()
ggplot(data=temp, aes(x = value))+
theme_bw(base_family = "HiraKakuProN-W3") +
facet_wrap(~pref.id,scales="free" )+
geom_density()
dim(temp)
temp
temp %>% group_by(var_name)
temp %>% group_by(var_name) %>% hist()
temp %>% group_by(var_name) %>% mean(value)
temp %>% group_by(var_name)
temp
library(plotly)
colnames(temp)
temp %>% plot_ly(x = value, type = "histogram", name = "Histogram")
temp %>% plot_ly(x = temp$value, type = "histogram", name = "Histogram")
temp %>% plot_ly(x = temp$value, type = "histogram", name = "Histogram",
frame=~var_name,
)
temp %>% plot_ly(x = temp$value, type = "histogram", name = "Histogram",
frame=~temp$var_name,
)
temp %>% plot_ly(x = temp$value, type = "histogram", name = "Histogram",
frame=~temp$var_name
)
temp
d_common %>% dplyr::select_if(is.numeric)
d_common %>% dplyr::select_if(is.numeric) %>%
select(-key, -pref.id)
d_common %>% dplyr::select_if(is.numeric) %>%
select(-key, -pref.id) %>% scale(center = 0, scale = 1)
iris[-5]
iris[-5] %>% scale()
d_common %>% dplyr::select_if(is.numeric) %>%
select(-key, -pref.id) %>% as.data.frame() %>% scale(center = 0, scale = 1)
d_common %>% dplyr::select_if(is.numeric) %>%
select(-key, -pref.id) %>% scale()
d_common %>% dplyr::select_if(is.numeric) %>%
select(-key, -pref.id) %>% scale() %>% tbl_df()
d_common_standarize<-
d_common %>% dplyr::select_if(is.numeric) %>%
select(-key, -pref.id) %>% scale() %>% tbl_df()
d_common_standarize
bind_cols(d_common$pref.id, d_common_standarize)
d_common$pref.id
d_common["pref.id"]
bind_cols(d_common["pref.id"], d_common_standarize)
d_common_standarize<-
d_common %>% dplyr::select_if(is.numeric) %>%
select(-key, -pref.id) %>% scale() %>% tbl_df()
d_common_standarize<-bind_cols(d_common["pref.id"], d_common_standarize)
d_common_standarize
d_common_standarize %>% dplyr::select_if(is.numeric) %>%
pivot_longer(
cols = -key,
names_to ="var_name" ,
values_to ="value"
) %>% select(-key)
d_common_standarize %>% dplyr::select_if(is.numeric) %>%
pivot_longer(
cols = -pref.id,
names_to ="var_name" ,
values_to ="value"
) %>% select(-key)
temp<-
d_common_standarize %>% dplyr::select_if(is.numeric) %>%
pivot_longer(
cols = -pref.id,
names_to ="var_name" ,
values_to ="value"
) %>% select(-pref.id)
temp
d_common_standarize_long<-
d_common_standarize %>% dplyr::select_if(is.numeric) %>%
pivot_longer(
cols = -pref.id,
names_to ="var_name" ,
values_to ="value"
)
d_common_standarize_long
d_common_standarize_long %>%
plot_ly(
x = value,
type = "histogram",
name = "Histogram",
frame =  ~var_name
)
plot_ly(
x =d_common_standarize_long$value,
type = "histogram",
name = "Histogram",
frame =  ~d_common_standarize_long$var_name
)
system("open .")
system("open .")
d_common %>% dplyr::select_if(is.numeric) %>%
select(-key, -pref.id) %>% scale() %>% tbl_df()
d_common %>% dplyr::select_if(is.numeric) %>%
select(-key, -pref.id) %>%
# scale() %>%
tbl_df()
d_common %>% dplyr::select_if(is.numeric) %>%
select(-key, -pref.id) %>%
# scale() %>%
tbl_df() %>% mapply(shapiro.test)
d_common %>% dplyr::select_if(is.numeric) %>%
select(-key, -pref.id) %>%
# scale() %>%
tbl_df() %>% mapply(~shapiro.test)
d_common %>% dplyr::select_if(is.numeric) %>%
select(-key, -pref.id) %>%
# scale() %>%
tbl_df() %>% purrr::map(shapiro.test)
iris$Sepal.Length %>% shapiro.test()
iris$Sepal.Length %>% shapiro.test() %>% broom::tidy()
d_common %>% dplyr::select_if(is.numeric) %>%
select(-key, -pref.id) %>%
# scale() %>%
tbl_df() %>% purrr::map_dbl(shapiro.test)
jc_shapiro <- function(x) {
shapiro.test(x) %>% broom::tidy()
}
d_common %>% dplyr::select_if(is.numeric) %>%
select(-key, -pref.id) %>%
# scale() %>%
tbl_df() %>% purrr::map_dbl(jc_shapiro)
d_common %>% dplyr::select_if(is.numeric) %>%
select(-key, -pref.id) %>%
# scale() %>%
tbl_df() %>% purrr::map(jc_shapiro)
d_common %>% dplyr::select_if(is.numeric) %>%
select(-key, -pref.id) %>%
# scale() %>%
tbl_df() %>% purrr::map(jc_shapiro) %>% tbl_df()
aaa<-d_common %>% dplyr::select_if(is.numeric) %>%
select(-key, -pref.id) %>%
# scale() %>%
tbl_df() %>% purrr::map(jc_shapiro) %>% tbl_df()
aaa %>% colnames()
aaa
aaa %>% DT::datatable()
aaa %>% t()
aaa %>% t() %>% [1]
aaa %>% t() %>% .[1]
aaa %>% t() %>% .[1:3]
aaa %>% t() %>% .[1:10]
aaa %>% t() %>% .[1:10] %>% names()
aaa<-d_common %>% dplyr::select_if(is.numeric) %>%
select(-key, -pref.id) %>%
# scale() %>%
tbl_df() %>% purrr::map(jc_shapiro)
aaa
aaa$Trt_rate_Hospitalization_Malignant_neoplasm_2017
x<-iris$Sepal.Length
shapiro.test(x) %>% broom::tidy()
shapiro.test(x) %>% broom::tidy() %>% select(p.value)
jc_shapiro <- function(x) {
shapiro.test(x) %>% broom::tidy() %>% select(p.value)
}
aaa<-d_common %>% dplyr::select_if(is.numeric) %>%
select(-key, -pref.id) %>%
# scale() %>%
tbl_df() %>% purrr::map(jc_shapiro)
aaa
aaa<-d_common %>% dplyr::select_if(is.numeric) %>%
select(-key, -pref.id) %>%
# scale() %>%
tbl_df() %>% purrr::map_df(jc_shapiro)
aaa
names(aaa)
rownames(aaa)
d_common %>% dplyr::select_if(is.numeric) %>%
select(-key, -pref.id)
d_common %>% dplyr::select_if(is.numeric) %>%
select(-key, -pref.id) %>% colnames()
names(aaa)<-d_common %>% dplyr::select_if(is.numeric) %>%
select(-key, -pref.id) %>% colnames()
aaa
jc_shapiro <- function(x) {
shapiro.test(x) %>% broom::tidy() %>% select(p.value)
}
aaa<-d_common %>% dplyr::select_if(is.numeric) %>%
select(-key, -pref.id) %>%
# scale() %>%
tbl_df() %>% purrr::map_df(jc_shapiro)
rownames(aaa)<-d_common %>% dplyr::select_if(is.numeric) %>%
select(-key, -pref.id) %>% colnames()
aaa
rownames(aaa)
DT::datatable()
DT::datatable(aaa)
iris %>% ggplot(aes(y = iris$Sepal.Width))+geom_line()
iris %>% ggplot(aes(y = Sepal.Width))+geom_line()
iris %>% ggplot(aes(x = Sepal.Width))+geom_line()
iris %>% ggplot(aes(x = Sepal.Width, y=iris$Petal.Length))+geom_line()
iris %>% rowid_to_column()
iris %>% rowid_to_column() %>% tbl_df()
iris %>% rowid_to_column() %>% tbl_df() %>% colnames()
ggplot(iris, aes(x=rowid, y=Sepal.Length))
ggplot(iris, aes(x=rowid, y=Sepal.Length))+
geom_line()
ggplot(iris, aes(x=rowid, y=Sepal.Length))+
geom_line()
iris %>% rowid_to_column() %>%
ggplot(aes(x=rowid, y=Sepal.Length))+
geom_line()
ls()
d_common_standarize_long
d_common_standarize_long %>% rowid_to_column() %>%
ggplot(aes(x=var_name, y=value))+
geom_line()
d_common_standarize_long %>% rowid_to_column() %>%
ggplot(aes(x=var_name, y=value, group=pref.id))+
geom_line()
d_common_standarize_long %>% rowid_to_column() %>%
ggplot(aes(x=var_name, y=value, group=pref.id, color = pref.id))+
geom_line()
d_common_standarize_long %>% rowid_to_column() %>%
ggplot(aes(x=var_name, y=value, group=pref.id,
color =as.factor(pref.id)))+
geom_line()
library(plotly)
dens <- with(diamonds, tapply(price, INDEX = cut, density))
df <- data.frame(
x = unlist(lapply(dens, "[[", "x")),
y = unlist(lapply(dens, "[[", "y")),
cut = rep(names(dens), each = length(dens[[1]]$x))
)
fig <- plot_ly(df, x = ~x, y = ~y, color = ~cut)
fig <- fig %>% add_lines()
fig
dens
unlist(lapply(dens, "[[", "x")),
unlist(lapply(dens, "[[", "x"))
dens
library(plotly)
storms %>%
count(year, status) %>%
plot_ly(y=~status, x =~n, color=~status) %>%
add_bars(frame=~year) %>%
layout(barmode="stack")
storms %>%
count(year, status)
storms %>%
count(year, status) %>% class()
ls()
storms %>%
count(year, status)
ls()
d_common_standarize_long
d_common_standarize_long %>%
plot_ly(y=~pref.id, x =~value, color=~status) %>%
add_bars()
d_common_standarize_long %>%
plot_ly(y=~pref.id, x =~value, color=~pref.id) %>%
add_bars()
storms %>%
count(year, status)
d_common_standarize_long %>%
plot_ly(y=~pref.id, x =~value, color=~pref.id) %>%
add_bars()
d_common_standarize_long
d_common
d_common$pref.J
d_common_standarize_long %>% add_column(d_common$pref.J)
d_common_standarize_long %>% left_join(d_common$pref.J, by=c(pref.id, pref.J))
d_common_standarize_long %>% left_join(d_common$pref.J,
by = c("pref.id"="pref.J"))
d_common
d_common_standarize_long %>% left_join(d_common$pref.J,
by = c("pref.id"))
d_common_standarize_long %>% left_join(d_common$pref.J,by = c("pref.id"="key"))
d_common_standarize_long
d_common_standarize_long
d_common$key
left_join(d_common_standarize_long, d_common,
by = c("pref.id"="key"))
left_join(d_common_standarize_long, d_common,
by = c("pref.id"="key")) %>% select(pref.J, everything())
left_join(d_common_standarize_long, d_common,
by = c("pref.id"="key")) %>% select(1,2,3,4)
left_join(d_common_standarize_long, d_common,
by = c("pref.id"="key")) %>% select(1,2,3,4)
left_join(d_common_standarize_long, d_common,
by = c("pref.id"="key")) %>% select(pref.J, 1,2,3,4)
left_join(d_common_standarize_long, d_common,
by = c("pref.id"="key")) %>% select(pref.J, 1,2,3)
left_join(d_common_standarize_long, d_common,
by = c("pref.id"="key")) %>% select(pref.J, 1,3)
left_join(d_common_standarize_long, d_common,
by = c("pref.id"="key")) %>% select(pref.J, 2,3)
temp<-left_join(d_common_standarize_long, d_common,
by = c("pref.id"="key")) %>% select(pref.J, 2,3)
temp %>%
plot_ly(y =  ~ pref.J,
x =  ~ value,
color =  ~ pref.J) %>%
add_bars()
temp %>%
plot_ly(y =  ~ pref.J,
x =  ~ value,
color =  ~ pref.J) %>%
add_bars(frame=~var_name)
temp %>%
plot_ly(y =  ~ pref.J,
x =  ~ value,
color =  ~ pref.J) %>%
add_bars(frame=~var_name)
temp %>%
plot_ly(y =  ~ pref.J,
x =  ~ value,
color =  ~ pref.J) %>%
add_bars(frame=~var_name)
temp
temp %>% filter(pref.J="和歌山")
temp %>% filter(pref.J=="和歌山")
temp %>% filter(pref.J=="和歌山"|
pref.J=="滋賀"|
pref.J=="青森"|
pref.J=="長野")
temp %>% filter(pref.J=="和歌山"|
pref.J=="滋賀"|
pref.J=="青森"|
pref.J=="長野") %>%
plot_ly(y =  ~ pref.J,
x =  ~ value,
color =  ~ pref.J) %>%
add_bars(frame=~var_name)
temp %>% filter(pref.J=="和歌山"|
pref.J=="青森"|
pref.J=="滋賀"|
pref.J=="長野") %>%
plot_ly(y =  ~ pref.J,
x =  ~ value,
color =  ~ pref.J) %>%
add_bars(frame=~var_name)
