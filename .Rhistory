)
)
jc.dotplot <- function(x) {
# x is HLE or LE in c()　vector
names(x)<-Wakayama::pref$pref.J
x<-x[order(x)]
}
colfunc <- colorRampPalette(c("gray90","black"))
par(family= "HiraKakuProN-W3")
dotchart(
main = "平均寿命(2015年, 男性)",
jc.dotplot(d_m$LE_2015),
cex = 0.7,
lcolor = "gray90",
pch = 19,
col = colfunc(47),
pt.cex = 1.5
)
abline(v = mean(d_m$LE_2015), lty = 2)
d_m %>% select(HLE_2016) %>% bind_cols(Wakayama::pref["pref.J"]) %>% dplyr::arrange(HLE_2016) %>% mutate(rank=row_number()) %>%DT::datatable()
jc.dotplot <- function(x) {
# x is HLE or LE in c()　vector
names(x)<-Wakayama::pref$pref.J
x<-x[order(x)]
}
colfunc <- colorRampPalette(c("gray90","black"))
par(family= "HiraKakuProN-W3")
dotchart(
main = "健康寿命(2016年, 男性)",
jc.dotplot(d_m$HLE_2016),
cex = 0.7,
lcolor = "gray90",
pch = 19,
col = colfunc(47),
pt.cex = 1.5
)
abline(v = mean(d_m$HLE_2016), lty = 2)
d_f %>% select(LE_2015) %>% bind_cols(Wakayama::pref["pref.J"]) %>% dplyr::arrange(LE_2015) %>% mutate(rank=row_number()) %>%DT::datatable()
jc.dotplot <- function(x) {
# x is HLE or LE in c()　vector
names(x)<-Wakayama::pref$pref.J
x<-x[order(x)]
}
colfunc <- colorRampPalette(c("gray90","black"))
par(family= "HiraKakuProN-W3")
dotchart(
main = "平均寿命(2015年, 女性)",
jc.dotplot(d_f$LE_2015),
cex = 0.7,
lcolor = "gray90",
pch = 19,
col = colfunc(47),
pt.cex = 1.5
)
abline(v = mean(d_f$LE_2015), lty = 2)
d_f %>% select(HLE_2016) %>% bind_cols(Wakayama::pref["pref.J"]) %>% dplyr::arrange(HLE_2016) %>% mutate(rank=row_number()) %>%DT::datatable()
jc.dotplot <- function(x) {
# x is HLE or LE in c()　vector
names(x)<-Wakayama::pref$pref.J
x<-x[order(x)]
}
colfunc <- colorRampPalette(c("gray90","black"))
par(family= "HiraKakuProN-W3")
dotchart(
main = "平均寿命(2015年, 女性)",
jc.dotplot(d_f$HLE_2016),
cex = 0.7,
lcolor = "gray90",
pch = 19,
col = colfunc(47),
pt.cex = 1.5
)
abline(v = mean(d_f$HLE_2016), lty = 2)
d_common %>% dplyr::select_if(is.numeric) %>% sapply(rank) %>%
tbl_df() %>% mutate(key=row_number()) %>% dplyr::filter(key==30) %>% t() %>% as.data.frame() %>% DT::datatable()
suppressMessages(library(plotly))
d_common_standarize<-
d_common %>% dplyr::select_if(is.numeric) %>%
# select(-key, -pref.id) %>%
select(-pref.id) %>%
scale() %>% tbl_df()
d_common_standarize<-
d_common %>% dplyr::select_if(is.numeric) %>%
select(-key, -pref.id) %>%
scale() %>% tbl_df()
d_common
d_common_standarize<-
d_common %>%
mutate(key=row_number()) %>%
dplyr::select_if(is.numeric) %>%
select(-key, -pref.id) %>%
scale() %>% tbl_df()
d_common
suppressMessages(library(readxl))
suppressMessages(library(dplyr))
suppressMessages(library(data.table))
suppressMessages(library(kableExtra))
suppressMessages(library(curl))
suppressMessages(library(tidyverse))
suppressMessages(library(plotly))
addr="https://raw.githubusercontent.com/luka3117/ClassData/master/Wakayama/DataFormat.csv"
d<-read_csv(url(addr),skip=1, locale = readr::locale(encoding = "CP932"))
d<-d[-95,]
d<-d %>% rename(key=X1)
d %>% dim()
d %>% head()
d %>% colnames() %>% cat()
addr="https://raw.githubusercontent.com/luka3117/ClassData/master/Wakayama/DataFormat3(HealthCare).csv"
d_health_care<-read_csv(url(addr),skip=1, locale = readr::locale(encoding = "CP932"))%>% rename(key=X1) %>%
select(1:5,7) %>% filter(!is.na(関係団体会員数))
d_health_care %>% head()
JpnEng<-"https://raw.githubusercontent.com/luka3117/ClassData/master/Wakayama/JpnEng.csv"
JpnEng<-read_csv(url(JpnEng))
JpnEng %>% head()
d %>% dim()
d %>% head()
d %>% colnames()
colnames(d)<-JpnEng$var_name_Eng
JpnEng %>% .[5:168, ]
d_common<-d[, sapply(d[48,], is.na)]
d_common<-d_common[1:47, ]
d_common<-d %>% select(1:6) %>% .[1:47,] %>% bind_cols(d_common)
d_common %>% DT::datatable()
d_common%>% head()
name <- function(x) {
!is.na(x)
}
d_mf<-d[, sapply(d[48,], name)]
d_mf %>% DT::datatable()
d_m<-d_mf %>% filter(sex=="M")
d_f<-d_mf %>% filter(sex=="F")
d_m %>% head()
suppressMessages(library(plotly))
t<-d_m %>% select(pref.J,HLE_2016,LE_2015) %>%
mutate(pref.J=forcats::fct_reorder(pref.J, LE_2015))
t$pref.J
t %>%
plot_ly() %>%
add_segments(
x=~HLE_2016,y=~pref.J ,
xend=~LE_2015,yend=~pref.J ,
# x = ~c, y = ~model,
# xend = ~h, yend = ~model,
color = I("gray"), showlegend = FALSE
) %>%
add_markers(
# x = ~c, y = ~model,
x=~HLE_2016,y=~pref.J ,
color = I("blue"),
name = "健康寿命"
) %>%
add_markers(
# x = ~h, y = ~model,
x=~LE_2015,y=~pref.J ,
color = I("red"),
name  = "平均寿命"
) %>%
layout(
xaxis = list(
range=c(60,83),
title="男性の平均寿命と健康寿命の差"
)
)
suppressMessages(library(plotly))
t<-d_f %>% select(pref.J,HLE_2016,LE_2015) %>%
mutate(pref.J=forcats::fct_reorder(pref.J, LE_2015))
t$pref.J
t %>%
# plot_ly(width = 600, height = 1000) %>%
plot_ly() %>%
add_segments(
x=~HLE_2016,y=~pref.J ,
xend=~LE_2015,yend=~pref.J ,
# x = ~c, y = ~model,
# xend = ~h, yend = ~model,
color = I("gray"), showlegend = FALSE
) %>%
add_markers(
# x = ~c, y = ~model,
x=~HLE_2016,y=~pref.J ,
color = I("blue"),
name = "健康寿命"
) %>%
add_markers(
# x = ~h, y = ~model,
x=~LE_2015,y=~pref.J ,
color = I("red"),
name  = "平均寿命"
) %>%
layout(
xaxis = list(
range=c(60,88),
title="女性の平均寿命と健康寿命の差"
)
)
jc.dotplot <- function(x) {
# x is HLE or LE in c()　vector
names(x)<-Wakayama::pref$pref.J
x<-x[order(x)]
}
colfunc <- colorRampPalette(c("gray90","black"))
par(family= "HiraKakuProN-W3")
dotchart(
main = "平均寿命(2015年, 男性)",
jc.dotplot(d_m$LE_2015),
cex = 0.7,
lcolor = "gray90",
pch = 19,
col = colfunc(47),
pt.cex = 1.5
)
abline(v = mean(d_m$LE_2015), lty = 2)
d_m %>% select(HLE_2016) %>% bind_cols(Wakayama::pref["pref.J"]) %>% dplyr::arrange(HLE_2016) %>% mutate(rank=row_number()) %>%DT::datatable()
jc.dotplot <- function(x) {
# x is HLE or LE in c()　vector
names(x)<-Wakayama::pref$pref.J
x<-x[order(x)]
}
colfunc <- colorRampPalette(c("gray90","black"))
par(family= "HiraKakuProN-W3")
dotchart(
main = "健康寿命(2016年, 男性)",
jc.dotplot(d_m$HLE_2016),
cex = 0.7,
lcolor = "gray90",
pch = 19,
col = colfunc(47),
pt.cex = 1.5
)
abline(v = mean(d_m$HLE_2016), lty = 2)
d_f %>% select(LE_2015) %>% bind_cols(Wakayama::pref["pref.J"]) %>% dplyr::arrange(LE_2015) %>% mutate(rank=row_number()) %>%DT::datatable()
jc.dotplot <- function(x) {
# x is HLE or LE in c()　vector
names(x)<-Wakayama::pref$pref.J
x<-x[order(x)]
}
colfunc <- colorRampPalette(c("gray90","black"))
par(family= "HiraKakuProN-W3")
dotchart(
main = "平均寿命(2015年, 女性)",
jc.dotplot(d_f$LE_2015),
cex = 0.7,
lcolor = "gray90",
pch = 19,
col = colfunc(47),
pt.cex = 1.5
)
abline(v = mean(d_f$LE_2015), lty = 2)
d_f %>% select(HLE_2016) %>% bind_cols(Wakayama::pref["pref.J"]) %>% dplyr::arrange(HLE_2016) %>% mutate(rank=row_number()) %>%DT::datatable()
jc.dotplot <- function(x) {
# x is HLE or LE in c()　vector
names(x)<-Wakayama::pref$pref.J
x<-x[order(x)]
}
colfunc <- colorRampPalette(c("gray90","black"))
par(family= "HiraKakuProN-W3")
dotchart(
main = "平均寿命(2015年, 女性)",
jc.dotplot(d_f$HLE_2016),
cex = 0.7,
lcolor = "gray90",
pch = 19,
col = colfunc(47),
pt.cex = 1.5
)
abline(v = mean(d_f$HLE_2016), lty = 2)
d_common %>% dplyr::select_if(is.numeric) %>% sapply(rank) %>%
tbl_df() %>% mutate(key=row_number()) %>% dplyr::filter(key==30) %>% t() %>% as.data.frame() %>% DT::datatable()
# purrr::map(iris[,-5], ~hist(.x))
suppressMessages(library(plotly))
d_common_standarize<-
d_common %>%
mutate(key=row_number()) %>%
dplyr::select_if(is.numeric) %>%
select(-key, -pref.id) %>%
scale() %>% tbl_df()
d_common_standarize<-bind_cols(d_common["pref.id"], d_common_standarize)
d_common_standarize_long<-
d_common_standarize %>% dplyr::select_if(is.numeric) %>%
pivot_longer(
cols = -pref.id,
names_to ="var_name" ,
values_to ="value"
)
d_common_standarize_long<-
d_common_standarize_long %>% left_join(JpnEng, c("var_name"="var_name_Eng"))
plot_ly(
x =d_common_standarize_long$value,
type = "histogram",
name = "Histogram",
# frame =  ~d_common_standarize_long$var_name,
frame =  ~d_common_standarize_long$var_name_Jpn,
text=d_common_standarize_long$var_name_Jpn
)
name1 <- function(temp) {
temp %>% select(value) %>% .[[1]] %>% density() %>%
broom::tidy()
}
d_common_standarize_long_density<-
d_common_standarize_long %>%
group_by(var_name_Jpn) %>% nest() %>%
mutate(dens=map(data, name1)) %>%
select(var_name_Jpn, dens) %>% unnest()
d_common_standarize_long_density %>%
plot_ly(x=~x, y=~y) %>%
# add_lines(frame=~var_name)
add_lines(frame=~var_name_Jpn,
text = ~paste(var_name_Jpn),
hoverinfo = "text"
) %>%
layout(title="分布")
jc_shapiro <- function(x) {
shapiro.test(x) %>% broom::tidy() %>% select(p.value) %>% round(3)
}
d_common_normality_test <-
d_common %>% dplyr::select_if(is.numeric) %>%
select(-key,-pref.id) %>%
# scale() %>%
tbl_df() %>% purrr::map_df(jc_shapiro)
rownames(d_common_normality_test) <-
d_common %>% dplyr::select_if(is.numeric) %>%
select(-key,-pref.id) %>% colnames()
d_common_normality_test %>%
# rownames_to_column() %>%
DT::datatable(d_common_normality_test,
options = list(
dom = 't',
scrollX = TRUE,
scrollCollapse = TRUE
)
)
# %>%
#     DT::formatStyle(c(1,2), fontSize = '30%')
suppressMessages(library(readxl))
suppressMessages(library(dplyr))
suppressMessages(library(data.table))
suppressMessages(library(kableExtra))
suppressMessages(library(curl))
suppressMessages(library(tidyverse))
suppressMessages(library(plotly))
addr="https://raw.githubusercontent.com/luka3117/ClassData/master/Wakayama/DataFormat.csv"
d<-read_csv(url(addr),skip=1, locale = readr::locale(encoding = "CP932"))
d<-d[-95,]
d<-d %>% rename(key=X1)
d %>% dim()
d %>% head()
d %>% colnames() %>% cat()
addr="https://raw.githubusercontent.com/luka3117/ClassData/master/Wakayama/DataFormat3(HealthCare).csv"
d_health_care<-read_csv(url(addr),skip=1, locale = readr::locale(encoding = "CP932"))%>% rename(key=X1) %>%
select(1:5,7) %>% filter(!is.na(関係団体会員数))
d_health_care %>% head()
JpnEng<-"https://raw.githubusercontent.com/luka3117/ClassData/master/Wakayama/JpnEng.csv"
JpnEng<-read_csv(url(JpnEng))
JpnEng %>% head()
d %>% dim()
d %>% head()
d %>% colnames()
colnames(d)<-JpnEng$var_name_Eng
JpnEng %>% .[5:168, ]
d_common<-d[, sapply(d[48,], is.na)]
d_common<-d_common[1:47, ]
d_common<-d %>% select(1:6) %>% .[1:47,] %>% bind_cols(d_common)
d_common %>% DT::datatable()
d_common%>% head()
name <- function(x) {
!is.na(x)
}
d_mf<-d[, sapply(d[48,], name)]
d_mf %>% DT::datatable()
d_m<-d_mf %>% filter(sex=="M")
d_f<-d_mf %>% filter(sex=="F")
d_m %>% head()
t %>%
plot_ly() %>%
add_segments(
x=~HLE_2016,y=~pref.J ,
xend=~LE_2015,yend=~pref.J ,
# x = ~c, y = ~model,
# xend = ~h, yend = ~model,
color = I("gray"), showlegend = FALSE
) %>%
add_markers(
# x = ~c, y = ~model,
x=~HLE_2016,y=~pref.J ,
color = I("blue"),
name = "健康寿命"
) %>%
add_markers(
# x = ~h, y = ~model,
x=~LE_2015,y=~pref.J ,
color = I("red"),
name  = "平均寿命"
) %>%
layout(
xaxis = list(
range=c(60,83),
title="男性の平均寿命と健康寿命の差"
)
)
system("open .")
system("open .")
system("open .")
faithful
suppressMessages(library(tidyverse))
suppressMessages(library(plotly))
faithful %>% write_csv("OldFaithful.csv")
system("open .")
animal
MASS::Animals
MASS::Animals %>% %>% write_csv("OldFaithful.csv")
MASS::Animals %>% %>% write_csv("Animals.csv")
system("open .")
MASS::Animals  %>% write_csv("Animals.csv")
MASS::Animals  %>% rownames_to_column() %>%
write_csv("Animals.csv")
MASS::Animals  %>% rownames_to_column(animal) %>%
write_csv("Animals.csv")
MASS::Animals  %>% rownames_to_column("animal") %>%
write_csv("Animals.csv")
anscombe  %>% rownames_to_column("animal") %>%
write_csv("anscombe.csv")
anscombe  %>%
write_csv("anscombe.csv")
system("open .")
system("open .")
system("open .")
system("open .")
system("open .")
system("open .")
system("open .")
system("open .")
addr="https://raw.githubusercontent.com/luka3117/ClassData/master/Wakayama/column_letter.csv"
d<-read_csv(url(addr),skip=1, locale = readr::locale(encoding = "CP932"))
suppressMessages(library(tidyverse))
d<-read_csv(url(addr),skip=1, locale = readr::locale(encoding = "CP932"))
d
addr="https://raw.githubusercontent.com/luka3117/ClassData/master/Wakayama/column_letter.csv"
d<-read_csv(url(addr),skip=1, locale = readr::locale(encoding = "CP932"))
d
addr="https://raw.githubusercontent.com/luka3117/ClassData/master/Wakayama/column_letter.csv"
d<-read_csv(url(addr))
d
addr="https://github.com/luka3117/ClassData/blob/master/Wakayama/columm_letter.csv"
d<-read_csv(url(addr))
d
read_csv("data/columm_letter.csv")
aa<-read_csv("data/columm_letter.csv")
write_csv(aa, "columm_letter1.csv")
system("open .")
read_csv(url(aa))
aa="https://github.com/luka3117/ClassData/blob/master/Wakayama/columm_letter1.csv"
read_csv(url(aa))
read_csv(url(aa),
locale = readr::locale(encoding = "CP932")
read_csv(url(aa),
locale = readr::locale(encoding = "CP932"))
d<-read_csv(
url(aa),
skip=1,
locale = readr::locale(encoding = "CP932")
)
d
d<-read_csv(
url(aa),
locale = readr::locale(encoding = "CP932")
)
d
read_csv(
url(aa))
read_csv(
url(aa),
locale = readr::locale(encoding = "utf-8")
)
aa="https://raw.githubusercontent.com/luka3117/ClassData/master/Wakayama/columm_letter1.csv"
d<-read_csv(
url(aa))
d
col_letter<-read_csv(
url(aa))
JpnEng<-read_csv(
url(aa), locale = readr::locale(encoding = "utf-8"))
JpnEng
aa="https://raw.githubusercontent.com/luka3117/ClassData/master/Wakayama/columm_letter1.csv"
bb="https://raw.githubusercontent.com/luka3117/ClassData/master/Wakayama/JpnEng.csv"
col_letter<-read_csv(
url(aa))
JpnEng<-read_csv(
url(bb), locale = readr::locale(encoding = "CP932"))
JpnEng
aa="https://raw.githubusercontent.com/luka3117/ClassData/master/Wakayama/columm_letter1.csv"
bb="https://raw.githubusercontent.com/luka3117/ClassData/master/Wakayama/JpnEng.csv"
col_letter<-read_csv(
url(aa))
JpnEng<-read_csv(
url(bb), locale = readr::locale(encoding = "CP932"))
JpnEng<-read_csv(
url(bb))
col_letter<-read_csv(
url(aa))
JpnEng<-read_csv(
url(bb))
col_letter
JpnEng
JpnEng
bind_cols(JpnEng, col_letter)
bind_cols(JpnEng, col_letter) %>% write_csv("aaa.csv")
system("open .")
system("open .")
system("open .")
system("open .")
system("open .")1
system("open .")
