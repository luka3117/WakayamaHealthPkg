lm(LE_2015~., data=LE_d_m_with_selected[,c(1, 33:65)]) %>% MASS::stepAIC() %>% broom::tidy()%>% filter(p.value<0.01)
lm(HLE_2016~., data=HLE_d_m_with_selected[,c(1, 2:32)]) %>% MASS::stepAIC() %>% broom::tidy() %>% filter(p.value<0.01)
lm(HLE_2016~., data=HLE_d_m_with_selected[,c(1, 33:65)]) %>% MASS::stepAIC() %>% broom::tidy()%>% filter(p.value<0.01)
temp1 <- lm(LE_2015~., data=LE_d_m_with_selected[,c(1, 2:32)]) %>% MASS::stepAIC() %>% broom::tidy() %>% filter(p.value<0.01)%>%select(term)
temp2 <- lm(LE_2015~., data=LE_d_m_with_selected[,c(1, 33:65)]) %>% MASS::stepAIC() %>% broom::tidy()%>% filter(p.value<0.01)%>%select(term)
temp3 <- lm(HLE_2016~., data=HLE_d_m_with_selected[,c(1, 2:32)]) %>% MASS::stepAIC() %>% broom::tidy() %>% filter(p.value<0.01)%>%select(term)
temp4 <- lm(HLE_2016~., data=HLE_d_m_with_selected[,c(1, 33:65)]) %>% MASS::stepAIC() %>% broom::tidy()%>% filter(p.value<0.01)%>%select(term)
tt<-bind_rows(temp1, temp2, temp3, temp4) %>% unique() %>% .[-1, ] %>% .$term %>% as.vector()
LE_d_m_with_selected_2nd_screen <- LE_d_common_m %>% bind_cols(LE_d_m[,-1]) %>% select(LE_2015, tt)
HLE_d_m_with_selected_2nd_screen <-HLE_d_common_m %>% bind_cols(HLE_d_m[,-1]) %>% select(HLE_2016, tt)
LE_d_f_with_selected_2nd_screen %>% colnames()
LE_d_m_with_selected_2nd_screen %>% colnames()
HLE_d_f_with_selected_2nd_screen %>% colnames()
HLE_d_m_with_selected_2nd_screen %>% colnames()
# ----------------- ----------------- ----------------- -----------------
#  ____            _   ____                           _
# |___ \ _ __   __| | / ___|  ___ _ __ ___  ___ _ __ (_)_ __   __ _
#   __) | '_ \ / _` | \___ \ / __| '__/ _ \/ _ \ '_ \| | '_ \ / _` |
#  / __/| | | | (_| |  ___) | (__| | |  __/  __/ | | | | | | | (_| |
# |_____|_| |_|\__,_| |____/ \___|_|  \___|\___|_| |_|_|_| |_|\__, |
#                                                             |___/
# ----------------- ----------------- ----------------- -----------------
# _____ _   _ ____
#| ____| \ | |  _ \
#|  _| |  \| | | | |
#| |___| |\  | |_| |
#|_____|_| \_|____/
#
# ----------------- ----------------- ----------------- -----------------
# ----------------- ----------------- ----------------- -----------------
#  ____          _   ____                           _
# |___ / _ __ __| | / ___|  ___ _ __ ___  ___ _ __ (_)_ __   __ _
#   |_ \| '__/ _` | \___ \ / __| '__/ _ \/ _ \ '_ \| | '_ \ / _` |
#  ___) | | | (_| |  ___) | (__| | |  __/  __/ | | | | | | | (_| |
# |____/|_|  \__,_| |____/ \___|_|  \___|\___|_| |_|_|_| |_|\__, |
#                                                           |___/
# ----------------- ----------------- ----------------- -----------------
# Work with this for obj
# 令和3年5月21日
# 4 obj after 2nd screen
LE_d_f_with_selected_2nd_screen #
LE_d_m_with_selected_2nd_screen
HLE_d_f_with_selected_2nd_screen
HLE_d_m_with_selected_2nd_screen
# 2nd screen data dim info
LE_d_f_with_selected_2nd_screen %>% dim()  # 47 28
HLE_d_f_with_selected_2nd_screen %>% dim()  # 47 28
LE_d_m_with_selected_2nd_screen %>% dim()  # 47 20
HLE_d_m_with_selected_2nd_screen %>% dim()  # 47 20
# 3rd screening start
#  _____ _____ __  __    _    _     _____
# |  ___| ____|  \/  |  / \  | |   | ____|
# | |_  |  _| | |\/| | / _ \ | |   |  _|
# |  _| | |___| |  | |/ ___ \| |___| |___
# |_|   |_____|_|  |_/_/   \_\_____|_____|
#
lm(LE_2015~., data = LE_d_f_with_selected_2nd_screen) %>% broom::tidy() %>% filter(p.value<.1)
lm(HLE_2016~., data = HLE_d_f_with_selected_2nd_screen) %>% broom::tidy() %>% filter(p.value<.1)
temp1 <- lm(LE_2015~., data = LE_d_f_with_selected_2nd_screen) %>% broom::tidy() %>% filter(p.value<.1)
temp2 <- lm(HLE_2016~., data = HLE_d_f_with_selected_2nd_screen) %>% broom::tidy() %>% filter(p.value<.1)
tt<-bind_rows(temp1[-1, ], temp2[-1, ]) %>% .$term %>%unique() %>%  as.vector()
LE_d_f_with_selected_3rd_screen <- LE_d_common_f %>% bind_cols(LE_d_f[,-1]) %>% select(LE_2015, tt)
HLE_d_f_with_selected_3rd_screen <-HLE_d_common_f %>% bind_cols(HLE_d_f[,-1]) %>% select(HLE_2016, tt)
#  __  __    _    _     _____
# |  \/  |  / \  | |   | ____|
# | |\/| | / _ \ | |   |  _|
# | |  | |/ ___ \| |___| |___
# |_|  |_/_/   \_\_____|_____|
#
lm(LE_2015~., data = LE_d_m_with_selected_2nd_screen) %>% broom::tidy() %>% filter(p.value<.1)
lm(HLE_2016~., data = HLE_d_m_with_selected_2nd_screen) %>% broom::tidy() %>% filter(p.value<.1)
temp1 <- lm(LE_2015~., data = LE_d_m_with_selected_2nd_screen) %>% broom::tidy() %>% filter(p.value<.1)
temp2 <- lm(HLE_2016~., data = HLE_d_m_with_selected_2nd_screen) %>% broom::tidy() %>% filter(p.value<.1)
tt<-bind_rows(temp1[-1, ], temp2[-1, ]) %>% .$term %>%unique() %>%  as.vector()
LE_d_m_with_selected_3rd_screen <- LE_d_common_m %>% bind_cols(LE_d_m[,-1]) %>% select(LE_2015, tt)
HLE_d_m_with_selected_3rd_screen <-HLE_d_common_m %>% bind_cols(HLE_d_m[,-1]) %>% select(HLE_2016, tt)
# 3rd screen data dim info
LE_d_f_with_selected_3rd_screen %>% dim()
HLE_d_f_with_selected_3rd_screen %>% dim()
LE_d_m_with_selected_3rd_screen %>% dim()
HLE_d_m_with_selected_3rd_screen %>% dim()
LE_d_f_with_selected_3rd_screen %>% colnames() %>% cat()
HLE_d_f_with_selected_3rd_screen %>% colnames() %>% cat()
LE_d_m_with_selected_3rd_screen %>% colnames() %>% cat()
HLE_d_m_with_selected_3rd_screen %>% colnames() %>% cat()
# ----------------- ----------------- ----------------- -----------------
#  _____         _   ____                           _
# |___ / _ __ __| | / ___|  ___ _ __ ___  ___ _ __ (_)_ __   __ _
#   |_ \| '__/ _` | \___ \ / __| '__/ _ \/ _ \ '_ \| | '_ \ / _` |
#  ___) | | | (_| |  ___) | (__| | |  __/  __/ | | | | | | | (_| |
# |____/|_|  \__,_| |____/ \___|_|  \___|\___|_| |_|_|_| |_|\__, |
#                                                           |___/
# ----------------- ----------------- ----------------- -----------------
#  _____ _   _ ____
# | ____| \ | |  _ \
# |  _| |  \| | | | |
# | |___| |\  | |_| |
# |_____|_| \_|____/
# ----------------- ----------------- ----------------- -----------------
pref_id<- d_m %>% select(pref.E:pref.J)
d_f_merge_X<-d_common[, 7:104] %>% bind_cols(d_f[, 7:70]) %>% select(-HLE_2016, -LE_2015)
d_m_merge_X<-d_common[, 7:104] %>% bind_cols(d_m[, 7:70]) %>% select(-HLE_2016, -LE_2015)
y_f <- d_f %>% select(LE_2015, HLE_2016)
y_m <- d_m %>% select(LE_2015, HLE_2016)
LE_d_f_final<-LE_d_f_with_selected_3rd_screen
HLE_d_f_final<-HLE_d_f_with_selected_3rd_screen
LE_d_m_final<-LE_d_m_with_selected_3rd_screen
HLE_d_m_final<-HLE_d_m_with_selected_3rd_screen
save.image("ScreenEnd.RData")
ls(list=rm())
rm(list = ls())
load("ScreenEnd.RData")
system("open .")
system("open .")
# devtools::install_github(repo = "luka3117/JcPackage/OsakaUniv2020")
# 使用package
suppressMessages(library(readxl))
suppressMessages(library(dplyr))
suppressMessages(library(data.table))
suppressMessages(library(kableExtra))
suppressMessages(library(curl))
suppressMessages(library(tidyverse))
suppressMessages(library(plotly))
suppressMessages(library(ggrepel))
load("ScreenEnd.RData")
LE_d_f_final
lm(LE_d_f_final$LE_2015~. )
lm(LE_2015~. , data = LE_d_f_final)
lm(LE_2015~. , data = LE_d_f_final) %>% broom::tidy()
lm(LE_2015~. , data = LE_d_f_final) %>% broom::glance()
lm(LE_2015~. , data = LE_d_f_final) %>% broom::tidy()
lm(LE_2015~. , data = LE_d_f_final) %>% broom::tidy() %>% DT::datatable()
lm(LE_2015~. , data = LE_d_f_final) %>%
left_join(var, by=c("term"="var_name_Eng"))
lm(LE_2015~. , data = LE_d_f_final) %>%
broom::tidy() %>%
left_join(var, by=c("term"="var_name_Eng"))
lm(LE_2015~. , data = LE_d_f_final) %>%
broom::tidy() %>%
left_join(var, by=c("term"="var_name_Eng")) %>%
select(terms, var_name_Jpn, everything())
lm(LE_2015~. , data = LE_d_f_final) %>%
broom::tidy() %>%
left_join(var, by=c("term"="var_name_Eng")) %>%
select(term, var_name_Jpn, everything())
lm(LE_2015~. , data = LE_d_f_final) %>%
broom::tidy() %>%
left_join(var, by=c("term"="var_name_Eng")) %>%
select(term, var_name_Jpn, everything()) %>% DT::datatable()
system("open .")
var$var_name_Jpn
var$var_name_Jpn
lm(LE_2015~. , data = LE_d_f_final) %>%MASS::stepAIC() %>%
broom::tidy() %>%
left_join(var, by=c("term"="var_name_Eng")) %>%
select(term, var_name_Jpn, everything()) %>% DT::datatable()
system("open .")
system("open .")
system("open .")
# devtools::install_github(repo = "luka3117/JcPackage/OsakaUniv2020")
# 使用package
suppressMessages(library(readxl))
suppressMessages(library(dplyr))
suppressMessages(library(data.table))
suppressMessages(library(kableExtra))
suppressMessages(library(curl))
suppressMessages(library(tidyverse))
suppressMessages(library(plotly))
suppressMessages(library(ggrepel))
suppressMessages(library(magrittr))
load("../ScreenEnd.RData")
# -----------------
# Q1:Do the final regression and interprete : with 4 data
# -----------------
# ----------------- ----------------- ----------------- -----------------
#  _____ _             _   _     __  __
# |  ___(_)_ __   __ _| | | |   |  \/  |
# | |_  | | '_ \ / _` | | | |   | |\/| |
# |  _| | | | | | (_| | | | |___| |  | |
# |_|   |_|_| |_|\__,_|_| |_____|_|  |_|
# ----------------- ----------------- ----------------- -----------------
options(digits = 5)              # Modify global options
lm(LE_2015~. , data = LE_d_f_final) %>%
broom::tidy() %>%
left_join(var, by=c("term"="var_name_Eng")) %>%
select(term, var_name_Jpn, everything(), -id,- address, -std.error, -columm_letter ) %>% DT::datatable() %>% DT::formatRound(columns=c('estimate', 'statistic', "p.value"), digits=3)
# -----------------
# Q1:Do the final regression and interprete : with 4 data
# -----------------
# ----------------- ----------------- ----------------- -----------------
#  _____ _             _   _     __  __
# |  ___(_)_ __   __ _| | | |   |  \/  |
# | |_  | | '_ \ / _` | | | |   | |\/| |
# |  _| | | | | | (_| | | | |___| |  | |
# |_|   |_|_| |_|\__,_|_| |_____|_|  |_|
# ----------------- ----------------- ----------------- -----------------
options(digits = 5)              # Modify global options
lm(HLE_2016~. , data = HLE_d_f_final) %>%
broom::tidy() %>%
left_join(var, by=c("term"="var_name_Eng")) %>%
select(term, var_name_Jpn, everything(), -id,- address, -std.error, -columm_letter ) %>% DT::datatable() %>% DT::formatRound(columns=c('estimate', 'statistic', "p.value"), digits=3)
# -----------------
# Q1:Do the final regression and interprete : with 4 data
# -----------------
# ----------------- ----------------- ----------------- -----------------
#  _____ _             _   _     __  __
# |  ___(_)_ __   __ _| | | |   |  \/  |
# | |_  | | '_ \ / _` | | | |   | |\/| |
# |  _| | | | | | (_| | | | |___| |  | |
# |_|   |_|_| |_|\__,_|_| |_____|_|  |_|
# ----------------- ----------------- ----------------- -----------------
options(digits = 5)              # Modify global options
lm(LE_2015~. , data = LE_d_m_final) %>%
broom::tidy() %>%
left_join(var, by=c("term"="var_name_Eng")) %>%
select(term, var_name_Jpn, everything(), -id,- address, -std.error, -columm_letter ) %>% DT::datatable() %>% DT::formatRound(columns=c('estimate', 'statistic', "p.value"), digits=3)
# -----------------
# Q1:Do the final regression and interprete : with 4 data
# -----------------
# ----------------- ----------------- ----------------- -----------------
#  _____ _             _   _     __  __
# |  ___(_)_ __   __ _| | | |   |  \/  |
# | |_  | | '_ \ / _` | | | |   | |\/| |
# |  _| | | | | | (_| | | | |___| |  | |
# |_|   |_|_| |_|\__,_|_| |_____|_|  |_|
# ----------------- ----------------- ----------------- -----------------
options(digits = 5)              # Modify global options
lm(HLE_2016~. , data = HLE_d_m_final) %>%
broom::tidy() %>%
left_join(var, by=c("term"="var_name_Eng")) %>%
select(term, var_name_Jpn, everything(), -id,- address, -std.error, -columm_letter ) %>% DT::datatable() %>% DT::formatRound(columns=c('estimate', 'statistic', "p.value"), digits=3)
LE_d_f_final.reg<-lm(LE_2015~. , data = LE_d_f_final)
d_f_.FA<-LE_d_f_final.reg$model[,-1] %>% zemi::JcFA()
rownames(d_f_.FA$VAR.rotate)<-colnames(LE_d_f_final.reg$model[,-1] )
d_f_.FA$VAR.rotate %>% data.frame() %>% rownames_to_column() %>%
left_join(var, by=c("rowname"="var_name_Eng")) %>%
select(rowname,var_name_Jpn,X1,X2) %>% rename(F1=X1, F2=X2) %>%
DT::datatable() %>% DT::formatRound(columns=c('F1', 'F2'), digits=3)
d_f_.FA$OBS.rotate %>% as.data.frame() %>% tbl_df() %>%
rename(F1=V1, F2=V2) %>%
mutate(pref.J=d_common$pref.J)%>% select(pref.J, everything()) %>%
DT::datatable() %>% DT::formatRound(columns=c('F1', 'F2'), digits=3)
#
#
# aa$VAR[,c(1:3)] %>% round(2)
#
#
# plot(aa$OBS.rotate,
#   aa$VAR.rotate)
# DT::datatable()
# aa=zemi::JcFA(zemi::USCrime)
#
# X_f<-LE_d_f_final.reg$model[,-1]
# X_f %>% dim()
#
#
#
# aa$d
# aa=zemi::JcFA(LE_d_f_final[,-1])
#
# HLE_d_f_final %>% colnames()
# #
# # aa$d
# # aa$OBS
# # aa$VAR
#
LE_d_m_final.reg<-lm(LE_2015~. , data = LE_d_m_final)
d_m_.FA<-LE_d_m_final.reg$model[,-1] %>% zemi::JcFA()
rownames(d_m_.FA$VAR.rotate)<-colnames(LE_d_m_final.reg$model[,-1] )
d_m_.FA$VAR.rotate %>% data.frame() %>% rownames_to_column() %>%
left_join(var, by=c("rowname"="var_name_Eng")) %>%
select(rowname,var_name_Jpn,X1,X2) %>% rename(F1=X1, F2=X2) %>%
DT::datatable() %>% DT::formatRound(columns=c('F1', 'F2'), digits=3)
d_m_.FA$OBS.rotate %>% as.data.frame() %>% tbl_df() %>%
rename(F1=V1, F2=V2) %>%
mutate(pref.J=d_common$pref.J)%>% select(pref.J, everything()) %>%
DT::datatable() %>% DT::formatRound(columns=c('F1', 'F2'), digits=3)
lm(LE_d_f_final$LE_2015~d_f_.FA$OBS.rotate) %>% broom::tidy() %>% DT::datatable() %>% DT::formatRound(columns=c('estimate', 'std.error', 'statistic', 'p.value'), digits=3)
lm(LE_d_f_final$LE_2015~d_f_.FA$OBS.rotate) %>% broom::glance()
lm(HLE_d_f_final$HLE_2016~d_f_.FA$OBS.rotate) %>% broom::tidy()%>% DT::datatable() %>% DT::formatRound(columns=c('estimate', 'std.error', 'statistic', 'p.value'), digits=3)
lm(HLE_d_f_final$HLE_2016~d_f_.FA$OBS.rotate) %>% broom::glance()
lm(LE_d_m_final$LE_2015~d_m_.FA$OBS.rotate) %>% broom::tidy()%>% DT::datatable() %>% DT::formatRound(columns=c('estimate', 'std.error', 'statistic', 'p.value'), digits=3)
lm(LE_d_m_final$LE_2015~d_m_.FA$OBS.rotate) %>% broom::glance()
lm(HLE_d_m_final$HLE_2016~d_m_.FA$OBS.rotate) %>% broom::tidy()%>% DT::datatable() %>% DT::formatRound(columns=c('estimate', 'std.error', 'statistic', 'p.value'), digits=3)
lm(HLE_d_m_final$HLE_2016~d_m_.FA$OBS.rotate) %>% broom::glance()
LE_d_f_final$LE_binary <- ifelse(LE_d_f_final$LE_2015>median(LE_d_f_final$LE_2015),1,0)
HLE_d_f_final$HLE_binary <- ifelse(HLE_d_f_final$HLE_2016>median(HLE_d_f_final$HLE_2016),1,0)
LE_d_m_final$LE_binary <- ifelse(LE_d_m_final$LE_2015>median(LE_d_m_final$LE_2015),1,0)
HLE_d_m_final$HLE_binary <- ifelse(HLE_d_m_final$HLE_2016>median(HLE_d_m_final$HLE_2016),1,0)
LE_d_f_final$LE_binary   # 女性
HLE_d_f_final$HLE_binary   # 女性
LE_d_m_final$LE_binary   # 男性
HLE_d_m_final$HLE_binary   # 男性
glm(LE_d_f_final$LE_binary ~ d_f_.FA$OBS.rotate, family =  "binomial")%>% broom::tidy() %>% DT::datatable() %>% DT::formatRound(columns=c('estimate', 'std.error', 'statistic', 'p.value'), digits=3)
glm(HLE_d_f_final$HLE_binary ~ d_f_.FA$OBS.rotate, family =  "binomial")%>% broom::tidy() %>% DT::datatable() %>% DT::formatRound(columns=c('estimate', 'std.error', 'statistic', 'p.value'), digits=3)
glm(LE_d_m_final$LE_binary ~ d_m_.FA$OBS.rotate, family =  "binomial")%>% broom::tidy() %>% DT::datatable() %>% DT::formatRound(columns=c('estimate', 'std.error', 'statistic', 'p.value'), digits=3)
glm(HLE_d_m_final$HLE_binary ~ d_m_.FA$OBS.rotate, family =  "binomial")%>% broom::tidy() %>% DT::datatable() %>% DT::formatRound(columns=c('estimate', 'std.error', 'statistic', 'p.value'), digits=3)
glmmML(LE_d_f_final$LE_binary ~ d_f_.FA$OBS.rotate, family =  "binomial", cluster=id)
install.packages("glmmML")
install.packages("glmmML")
library(glmmML)
library(glmmML)
glmmML(LE_d_f_final$LE_binary ~ d_f_.FA$OBS.rotate, family =  "binomial", cluster=id)
LE_d_f_final$LE_binary
d_f_.FA
d_f_.FA$OBS.rotate
LE_binary %>% bind_cols(d_f_.FA$OBS.rotate)
LE_binary
LE_d_f_final$LE_binary
LE_d_f_final$LE_binary %>% bind_cols(d_f_.FA$OBS.rotate)
LE_d_f_final$LE_binary
LE_d_f_final$LE_binary %>% enframe()
LE_d_f_final$LE_binary %>% enframe() %>% bind_cols(d_f_.FA$OBS.rotate)
LE_d_f_final$LE_binary %>% enframe() %>%  data_frame(bind_cols(d_f_.FA$OBS.rotate))
data_frame(bind_cols(d_f_.FA$OBS.rotate))
data_frame(bind_cols(d_f_.FA$OBS.rotate))
data_frame(d_f_.FA$OBS.rotate)
as.data.frame(d_f_.FA$OBS.rotate)
LE_d_f_final$LE_binary %>% enframe() %>%  bind_cols(as.data.frame(d_f_.FA$OBS.rotate))
LE_d_f_final$LE_binary %>% enframe() %>% as.factor()
LE_d_f_final$LE_binary %>% enframe()
LE_d_f_final$LE_binary %>% enframe() %>%
bind_cols(as.data.frame(d_f_.FA$OBS.rotate))
LE_d_f_final$LE_binary
LE_d_f_final$LE_binary %>% enframe() %>%
bind_cols(as.data.frame(d_f_.FA$OBS.rotate))
LE_d_f_final$LE_binary %>% enframe() %>%
bind_cols(as.data.frame(d_f_.FA$OBS.rotate))
%>% rename(LE_binary=value,F1=V1, F2=V2) %>%
LE_d_f_final$LE_binary %>% enframe() %>%
bind_cols(as.data.frame(d_f_.FA$OBS.rotate))
%>% rename(LE_binary=value,F1=V1, F2=V2) %>% mutate(LE_binary=as.factor(LE_binary))
LE_d_f_final$LE_binary %>% enframe() %>%
bind_cols(as.data.frame(d_f_.FA$OBS.rotate))
%>% rename(LE_binary=value,F1=V1, F2=V2) %>% mutate(LE_binary=as.factor(.$LE_binary))
LE_d_f_final$LE_binary %>% enframe() %>%
bind_cols(as.data.frame(d_f_.FA$OBS.rotate))
%>% rename(LE_binary=value,F1=V1, F2=V2) %>% mutate(LE_binary=as.factor(LE_binary))
LE_d_f_final$LE_binary %>% enframe() %>%
bind_cols(as.data.frame(d_f_.FA$OBS.rotate))
%>% rename(LE_binary=value,F1=V1, F2=V2) %>% mutate(LE_binary=as.factor(LE_binary))
LE_d_f_final$LE_binary %>% enframe() %>%
bind_cols(as.data.frame(d_f_.FA$OBS.rotate))%>% rename(LE_binary=value,F1=V1, F2=V2) %>% mutate(LE_binary=as.factor(LE_binary))
aaaa=LE_d_f_final$LE_binary %>% enframe() %>%
bind_cols(as.data.frame(d_f_.FA$OBS.rotate))%>% rename(LE_binary=value,F1=V1, F2=V2) %>% mutate(LE_binary=as.factor(LE_binary))
glmmML(LE_binary ~ F1+F2, family =  "binomial", cluster=id, data=aaaa)
glmmML(LE_binary ~ F1+F2, family =  "binomial", cluster=name, data=aaaa)
glm(LE_d_f_final$LE_binary ~ d_f_.FA$OBS.rotate, family =  "binomial")
system("open .")
system("open .")
?glmmML
help(package = "glmmML")
id <- factor(rep(1:20, rep(5, 20)))
y <- rbinom(100, prob = rep(runif(20), rep(5, 20)), size = 1)
x <- rnorm(100)
dat <- data.frame(y = y, x = x, id = id)
dat
glmmML(y ~ x, data = dat, cluster = id)
library(glmmML)
glmmML(y ~ x, data = dat, cluster = id)
id <- factor(rep(1:20, rep(5, 20)))
y <- rbinom(100, prob = rep(runif(20), rep(5, 20)), size = 1)
x <- rnorm(100)
dat <- data.frame(y = y, x = x, id = id)
dat
install.packages("vctrs")
install.packages("vctrs")
## R code 4.37
library(rethinking)
data(Howell1); d <- Howell1; d2 <- d[ d$age >= 18 , ]
plot( d2$height ~ d2$weight )
## R code 4.38
set.seed(2971)
N <- 100                   # 100 lines
a <- rnorm( N , 178 , 20 )
b <- rnorm( N , 0 , 10 )
a
b
## R code 4.39
plot( NULL , xlim=range(d2$weight) , ylim=c(-100,400) ,
xlab="weight" , ylab="height" )
abline( h=0 , lty=2 )
abline( h=272 , lty=1 , lwd=0.5 )
mtext( "b ~ dnorm(0,10)" )
xbar <- mean(d2$weight)
for ( i in 1:N ) curve( a[i] + b[i]*(x - xbar) ,
from=min(d2$weight) , to=max(d2$weight) , add=TRUE ,
col=col.alpha("black",0.2) )
Howell1
d<-Howell1
d
suppressMessages(library(tidyverse))
d %>% tbl_df()
d %>% tbl_df()
d
d %>% tbl_df()
d %>% dim()
d %>% filter(age>=18)
d<-d %>% filter(age>=18)
d %>% dim()
alist(
d$height~dnorm(mu, sigma)
mu~beta0+beta1*d$weight,
beta0~dnorm(156, 100),
beta1~dnorm(0, 10),
sigma ~ dunif(0, 50)
)
alist(
d$height~dnorm(mu, sigma)
mu~beta0+beta1*d$weight,
beta0~dnorm(156, 100),
beta1~dnorm(0, 10),
sigma ~ dunif(0, 50)
)
alist(
d$height~dnorm(mu, sigma),
mu~beta0+beta1*d$weight,
beta0~dnorm(156, 100),
beta1~dnorm(0, 10),
sigma ~ dunif(0, 50)
)
map(alist(
d$height~dnorm(mu, sigma),
mu~beta0+beta1*d$weight,
beta0~dnorm(156, 100),
beta1~dnorm(0, 10),
sigma ~ dunif(0, 50)
)
)
m4.3<-map(alist(
height~dnorm(mu, sigma),
mu~beta0+beta1*weight,
beta0~dnorm(156, 100),
beta1~dnorm(0, 10),
sigma ~ dunif(0, 50)
), data=d
)
library(rethinking)
m4.3<-map(alist(
height~dnorm(mu, sigma),
mu~beta0+beta1*weight,
beta0~dnorm(156, 100),
beta1~dnorm(0, 10),
sigma ~ dunif(0, 50)
), data=d
)
m4.3<-
rethinking::(alist(
height~dnorm(mu, sigma),
mu~beta0+beta1*weight,
beta0~dnorm(156, 100),
beta1~dnorm(0, 10),
sigma ~ dunif(0, 50)
), data=d
)
m4.3<-
rethinking::map(alist(
height~dnorm(mu, sigma),
mu~beta0+beta1*weight,
beta0~dnorm(156, 100),
beta1~dnorm(0, 10),
sigma ~ dunif(0, 50)
), data=d
)
m4.3
m4.3 %>% fit()
m4.3 %>% summary()
precis(m4.3)
precis(m4.3, corr=T)
precis(m4.3, corr=T)
precis(m4.3, corr=T)
precis(m4.3, corr=T)
round( vcov( m4.3 ) , 3 )
m4.3
coef(m4.3["beta0"])
m4.3["beta0"]
coef(m4.3)
coef(m4.3)["beta0"]
coef(m4.3)["beta1"]
abline(coef(m4.3)["beta0"],
coef(m4.3)["beta1"]
)
abline(coef(m4.3)["beta0"],
coef(m4.3)["beta1"]
)
plot(d$height~d$weight)
abline(coef(m4.3)["beta0"],
coef(m4.3)["beta1"]
)
extract.samples(m4.3)
extract.samples(m4.3) %>% dim()
post<-extract.samples(m4.3)
post
post %>% dim()
post %>% tbl_df()
post %>% class()
post$beta0
post %>% class()
mu_at_50<-post$beta0 + post$beta1*50
mu_at_50
mu_at_50 %>% dim()
mu_at_50 %>% dim()
mu_at_50 %>% length()
dens(mu_at_50)
HPDI(mu_at_50)
link(m4.3)
link(m4.3)
link(m4.3) %>% class()
link(m4.3) %>% dim()
m4.3
link(m4.3) %>% dim()
link(m4.3)
